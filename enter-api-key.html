<!DOCTYPE html>
<html>
    <head>
        <title>API Key</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="css/style.css">
		<link href="fontawesome/css/all.css" rel="stylesheet">
    </head>

    <body>
	 <div class="container">
		<form id="editForm">
		<h1>Your api key</h1>
			<div class="row">
				<div class="col-25">
					<label for="API_Key">Please enter a valid API key: </label><br/>
				</div>
				<div class="col-55">
			    		<input type="email" id="apiKey" name="apiKey"/><br><br>
				</div>
			</div>
			<div class="row">
			    <button type="button" id="submitApiKey" class="fas fa-check"> Submit</button>
			</div>
		</form>
	    </div>
        <script>
            let rootPath = "https://mysite.itvarsity.org/api/ContactBook/";
            document.getElementById("submitApiKey").addEventListener('click', setApiKey);

            function setApiKey(e){
                e.preventDefault();

                apiKey = document.getElementById("apiKey").value;
                fetch(rootPath + "controller/api-key/?apiKey=" + apiKey)
                .then(function(response){
                    return response.text();
                })
                .then(function(data){

                    if(data == "1") {
                        localStorage.setItem("apiKey", apiKey);
                        window.open("index.html", "_self");
                    }else {
                        alert(data + "Invalid API key Entered!");
                    }
                })
            }
        </script>
    </body>
</html>
